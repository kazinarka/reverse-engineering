# Reverse Engineering Solana Arbitrage Bot (G2E4eoenFMirpFKRfHNo2koDP7mrhnNWVwxyHASSpjQD)

## Описание проекта

В этом репозитории собраны результаты реверс-инжиниринга и аналитики по Solana-программе-арбитражному боту с адресом G2E4eoenFMirpFKRfHNo2koDP7mrhnNWVwxyHASSpjQD. Контракт предназначен для автоматического поиска и исполнения арбитражных сделок между различными DEX-площадками Solana с целью получения прибыли.

### Основная логика работы контракта
- Контракт принимает инструкцию с маршрутом обмена (multi-hop swap route), количеством шагов (hop), суммой и параметрами (минимальная прибыль, процент чаевых).
- Для каждого шага маршрута определяется нужная DEX-платформа (всего интегрировано 21 DEX, включая Meteora, Raydium, Orca, Pump.fun и др.).
- На каждом шаге вызывается соответствующий CPI (внешний вызов) в DEX с передачей нужных аккаунтов.
- После завершения всех обменов контракт проверяет, получена ли прибыль (выходной баланс превышает входной).
- Если прибыль есть — вычисляется и отправляется чаевые (tip) на указанный адрес (например, для Jito).
- Если прибыль не достигнута — транзакция откатывается с ошибкой.

## Структура файлов аналитики и декомпиляции

- **G2E4_program.so** — оригинальный бинарный файл Solana-программы (SBF/eBPF).
- **G2E4_disassembly.txt** — полный дизассемблированный код (BPF, 15 878 строк).
- **G2E4_decompiled.c** — декомпилированный C-псевдокод (Ghidra, 10 460 строк, 137 функций).
- **G2E4_entrypoint.c** — попытка декомпиляции главной функции (entrypoint), не завершена из-за сложности.
- **G2E4_program_analysis.json** — основная аналитика: список всех интегрированных DEX, инфраструктурных программ, карта функций из Ghidra, описание логики маршрутизации и расчёта прибыли.
- **G2E4_full_analysis.json** — расширенная аналитика: подробные данные по транзакциям, структурам, ошибкам, маршрутам.
- **identify_programs.py** — скрипт для извлечения и идентификации всех жёстко зашитых pubkey (адресов программ) из бинарника.
- **extract_pubkeys.py** — вспомогательный скрипт для извлечения pubkey из .rodata.
- **re_analyze.py** — скрипт для повторного анализа и обновления аналитических файлов.
- **reconstructed-source/** — директория с реконструированным исходным кодом (Rust/Anchor), полученным на основе декомпиляции и анализа (НЕ оригинальный исходник, а максимально точная реконструкция логики).

## Кратко о логике и назначении контракта
- Контракт — это арбитражный бот, который автоматически ищет и реализует выгодные маршруты обмена между разными DEX на Solana.
- Входные данные: маршрут обмена (последовательность DEX), сумма, параметры прибыли и чаевых.
- Внутри: для каждого шага вызывается нужный DEX через CPI, баланс отслеживается до и после.
- Если итоговый баланс выше начального — часть прибыли отправляется как чаевые, остальное остаётся на аккаунте бота.
- Если нет прибыли — транзакция отменяется.
- Контракт поддерживает 21 DEX и инфраструктурные программы (SPL Token, System, ATA и др.), а также работу с токенами Token-2022.

---

**Внимание:** исходный код в reconstructed-source/ — это реконструкция, а не оригинал. Все остальные файлы — результаты анализа, декомпиляции и вспомогательные скрипты для реверса.